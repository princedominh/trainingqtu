<table role="grid">
    <thead>
        <tr>
            <th rowspan="3"><input type="checkbox" /></th>
            <th rowspan="3">Khoa</th>
            <th rowspan="3">Lớp</th>
            <th rowspan="3">Học phần</th>
            <th rowspan="3">Giảng viên</th>
            <th rowspan="3">Tổng tiết</th>
            <th colspan="7">
    <div class="row">
        <div class="small-1 columns"><a href="#"><i class="fi-arrow-left"></i></a></div>
        <div class="small-10 columns weekinschedule">Tuần 41 (11/5 đến 17/5)</div>
        <div class="small-1 columns"><a href="#"><i class="fi-arrow-right"></i></a></div>
    </div>
</th>
</tr>
<tr>
    <th class="dateofweek">2</th>
    <th class="dateofweek">3</th>
    <th class="dateofweek">4</th>
    <th class="dateofweek">5</th>
    <th class="dateofweek">6</th>
    <th class="dateofweek">7</th>
    <th class="dateofweek">CN</th>
</tr>
<tr>
    <th class="dateinschedule">11/5</th>
    <th class="dateinschedule">12/5</th>
    <th class="dateinschedule">13/5</th>
    <th class="dateinschedule">14/5</th>
    <th class="dateinschedule">15/5</th>
    <th class="dateinschedule">16/5</th>
    <th class="dateinschedule">17/5</th>
</tr>
</thead>
<tbody>
    <tr class="row_cid_123" course_id="123">
        <td><input type="checkbox" id="row_course_id_123" /></td>
        <td>CNTT</td>
        <td>K9.101</td>
        <td>Những NLCB của CNML 2, 3 (<i class="fi-projection-screen" title="Máy chiếu"></i> <i class="fi-torso" title="Thỉnh giảng"></i>)</td>
        <td>ThS. Trần Thị Hoài Thương</td>
        <td>45</td>
        <td class="cell_details">
            <div class="cell_period" data_used=",1,2,3,">
                <span id="12345" class="success label" period="p1_3" data-dropdown="drop_sd_12345" aria-controls="drop_sd_12345" aria-expanded="false">1-3</span>
                <ul id="drop_sd_12345" class="f-dropdown" data-dropdown-content aria-hidden="true" tabindex="-1">
                    <li><a class="del" spanid="12345">Xóa</a></li>				  
                </ul>
            </div>
            <a data-dropdown="drop1" aria-controls="drop1" aria-expanded="false"><i class="fi-plus"></i></a>
            <ul id="drop1" class="f-dropdown" data-dropdown-content aria-hidden="true" tabindex="-1">
                <li><a class="add" href="#" period="p1_3">1-3</a></li>
                <li><a class="add" href="#" period="p1_2">1-2</a></li>
                <li><a class="add" href="#" period="p3_4">3-4</a></li>
                <li><a class="add" href="#" period="p2_4">2-4</a></li>
                <li><a class="add" href="#" period="p1_4">1-4</a></li>
                <li><a class="add" href="#" period="p5_7">5-7</a></li>
                <li><a class="add" href="#" period="p5_6">5-6</a></li>
                <li><a class="add" href="#" period="p7_8">7-8</a></li>
                <li><a class="add" href="#" period="p5_8">5-8</a></li>
                <li><a class="add" href="#" period="p6_8">6-8</a></li>
                <li><a class="add" href="#" period="p9_11">9-11</a></li>
                <li><a class="add" href="#" period="p9_10">9-10</a></li>
                <li><a class="add" href="#" period="p10_11">10-11</a></li>
            </ul>
        </td>
        <td class="cell_details"><a href="#"><i class="fi-plus"></i></a></td>
        <td class="cell_details"><a href="#"><i class="fi-plus"></i></a></td>
        <td class="cell_details"><a href="#"><i class="fi-plus"></i></a></td>
        <td class="cell_details"><span class="success label">1-3</span><span class="secondary label">9-11</span><a href="#"><i class="fi-plus"></i></a></td>
        <td class="cell_details"><span class="alert label">5-7</span><span class="secondary label">9-11</span><a href="#"><i class="fi-plus"></i></a></td>
        <td class="cell_details"><a href="#"><i class="fi-plus"></i></a></td>
    </tr>
</tbody>
</table>

<script>
    
    $(document).foundation();
    $(function() {

        $(".del").on("click",delClick);

        $(".f-dropdown li a.add").click(function() {
            var dataUsed = $(this).parents(".cell_details").children(".cell_period").attr('data_used');
            eval('var dataUse = class_period.'+$(this).attr('period')+'.use');
            var is_valid = true;
            for(i=0; i < dataUse.length; i++){
                if(dataUsed.indexOf(','+dataUse[i]+',')>=0) { //co chua dataUse[i] thi 
                    is_valid = false;
                }
            }
            if (is_valid) {
                $(this).parents(".cell_details").children(".cell_period").ttdetail({
                    class_p     : '',
                    period      : $(this).attr('period')
                });
                
                //update data_used
                for(i=0; i < dataUse.length; i++){
                    dataUsed+= ''+dataUse[i]+',';
                }
                $(this).parents(".cell_details").children(".cell_period").attr('data_used',dataUsed);
            }
        });

    });
</script>